/*! chevrotain - v0.14.0 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("chevrotain",[],e):"object"==typeof exports?exports.chevrotain=e():t.chevrotain=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";var r=n(1),o=n(11),i=n(10),a=n(5),s=n(7),c=n(22),u=n(16),p={};p.VERSION="0.14.0",p.Parser=r.Parser,p.ParserDefinitionErrorType=r.ParserDefinitionErrorType,p.Lexer=o.Lexer,p.LexerDefinitionErrorType=o.LexerDefinitionErrorType,p.Token=i.Token,p.VirtualToken=i.VirtualToken,p.EOF=i.EOF,p.extendToken=i.extendToken,p.extendLazyToken=i.extendLazyToken,p.tokenName=i.tokenName,p.tokenLabel=i.tokenLabel,p.EMPTY_ALT=r.EMPTY_ALT,p.exceptions={},p.exceptions.isRecognitionException=a.exceptions.isRecognitionException,p.exceptions.EarlyExitException=a.exceptions.EarlyExitException,p.exceptions.MismatchedTokenException=a.exceptions.MismatchedTokenException,p.exceptions.NotAllInputParsedException=a.exceptions.NotAllInputParsedException,p.exceptions.NoViableAltException=a.exceptions.NoViableAltException,p.gast={},p.gast.GAstVisitor=s.gast.GAstVisitor,p.gast.Flat=s.gast.Flat,p.gast.Repetition=s.gast.Repetition,p.gast.RepetitionWithSeparator=s.gast.RepetitionWithSeparator,p.gast.RepetitionMandatory=s.gast.RepetitionMandatory,p.gast.RepetitionMandatoryWithSeparator=s.gast.RepetitionMandatoryWithSeparator,p.gast.Option=s.gast.Option,p.gast.Alternation=s.gast.Alternation,p.gast.NonTerminal=s.gast.NonTerminal,p.gast.Terminal=s.gast.Terminal,p.gast.Rule=s.gast.Rule,p.interperter={},p.interperter.NextAfterTokenWalker=u.NextAfterTokenWalker,p.clearCache=c.clearCache,t.exports=p},function(t,e,n){"use strict";function r(t){return void 0===t&&(t=void 0),function(){return t}}function o(t){this.name=y,this.message=t}var i=n(2),a=n(5),s=n(3),c=n(6),u=n(8),p=n(4),l=n(18),f=n(10),h=n(15),T=n(20),E=n(16),d=n(19),A=n(9);!function(t){t[t.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",t[t.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",t[t.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",t[t.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",t[t.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",t[t.LEFT_RECURSION=5]="LEFT_RECURSION",t[t.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",t[t.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS"}(e.ParserDefinitionErrorType||(e.ParserDefinitionErrorType={}));var y=(e.ParserDefinitionErrorType,"InRuleRecoveryException"),_=new f.EOF;Object.freeze(_);var O="1",v="2",g="3",m="4",N="5",R="6",L=Object.freeze({recoveryEnabled:!1,maxLookahead:5,ignoredIssues:{}}),S=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0});e.EMPTY_ALT=r;var I={},P=function(){function t(t,e,n){if(void 0===n&&(n=L),this._errors=[],this._input=[],this.inputIdx=-1,this.savedTokenIdx=-1,this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.tokensMap=void 0,this.definedRulesNames=[],this.shortRuleNameToFull=new s.HashTable,this.ruleShortNameIdx=0,this._productions=new s.HashTable,this._input=t,this.recoveryEnabled=p.has(n,"recoveryEnabled")?n.recoveryEnabled:L.recoveryEnabled,this.recoveryEnabled||(this.attemptInRepetitionRecovery=p.NOOP),this.maxLookahead=p.has(n,"maxLookahead")?n.maxLookahead:L.maxLookahead,this.ignoredIssues=p.has(n,"ignoredIssues")?n.ignoredIssues:L.ignoredIssues,this.className=s.classNameFromInstance(this),this.firstAfterRepMap=i.getFirstAfterRepForClass(this.className),this.classLAFuncs=i.getLookaheadFuncsForClass(this.className),i.CLASS_TO_DEFINITION_ERRORS.containsKey(this.className)?this.definitionErrors=i.CLASS_TO_DEFINITION_ERRORS.get(this.className):(this.definitionErrors=[],i.CLASS_TO_DEFINITION_ERRORS.put(this.className,this.definitionErrors)),p.isArray(e))this.tokensMap=p.reduce(e,function(t,e){return t[f.tokenName(e)]=e,t},{});else{if(!p.isObject(e))throw new Error("'tokensMapOrArr' argument must be An Array of Token constructors or a Dictionary of Tokens.");this.tokensMap=p.cloneObj(e)}this.tokensMap[f.tokenName(f.EOF)]=f.EOF,void 0===i.CLASS_TO_OR_LA_CACHE[this.className]&&i.initLookAheadKeyCache(this.className),this.orLookaheadKeys=i.CLASS_TO_OR_LA_CACHE[this.className],this.manyLookaheadKeys=i.CLASS_TO_MANY_LA_CACHE[this.className],this.manySepLookaheadKeys=i.CLASS_TO_MANY_SEP_LA_CACHE[this.className],this.atLeastOneLookaheadKeys=i.CLASS_TO_AT_LEAST_ONE_LA_CACHE[this.className],this.atLeastOneSepLookaheadKeys=i.CLASS_TO_AT_LEAST_ONE_SEP_LA_CACHE[this.className],this.optionLookaheadKeys=i.CLASS_TO_OPTION_LA_CACHE[this.className]}return t.performSelfAnalysis=function(e){var n,r=[],o=s.classNameFromInstance(e);if(""===o)throw Error("A Parser's constructor may not be an anonymous Function, it must be a named function\nThe constructor's name is used at runtime for performance (caching) purposes.");if(!i.CLASS_TO_SELF_ANALYSIS_DONE.containsKey(o)){i.CLASS_TO_SELF_ANALYSIS_DONE.put(o,!0);var a=e._productions,f=new s.HashTable;p.forEach(a.keys(),function(t){var e=a.get(t);f.put(t,A.cloneProduction(e))}),i.getProductionsForClass(o).putAll(f),r=i.CLASS_TO_DEFINITION_ERRORS.get(o);var h=c.resolveGrammar(f);if(r.push.apply(r,h),p.isEmpty(h)){var T=u.validateGrammar(f.values(),e.maxLookahead,e.ignoredIssues);r.push.apply(r,T)}if(!p.isEmpty(r)&&!t.DEFER_DEFINITION_ERRORS_HANDLING)throw n=p.map(r,function(t){return t.message}),new Error("Parser Definition Errors detected\n: "+n.join("\n-------------------------------\n"));if(p.isEmpty(r)){var E=l.computeAllProdsFollows(f.values());i.setResyncFollowsForClass(o,E)}}if(!p.isEmpty(i.CLASS_TO_DEFINITION_ERRORS.get(o))&&!t.DEFER_DEFINITION_ERRORS_HANDLING)throw n=p.map(i.CLASS_TO_DEFINITION_ERRORS.get(o),function(t){return t.message}),new Error("Parser Definition Errors detected\n: "+n.join("\n-------------------------------\n"))},Object.defineProperty(t.prototype,"errors",{get:function(){return p.cloneArr(this._errors)},set:function(t){this._errors=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"input",{get:function(){return p.cloneArr(this._input)},set:function(t){this.reset(),this._input=t},enumerable:!0,configurable:!0}),t.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this._input=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[]},t.prototype.isAtEndOfInput=function(){return this.LA(1)instanceof f.EOF},t.prototype.getGAstProductions=function(){return i.getProductionsForClass(this.className)},t.prototype.isBackTracking=function(){return!p.isEmpty(this.isBackTrackingStack)},t.prototype.getCurrRuleFullName=function(){var t=p.last(this.RULE_STACK);return this.shortRuleNameToFull.get(t)},t.prototype.shortRuleNameToFullName=function(t){return this.shortRuleNameToFull.get(t)},t.prototype.getHumanReadableRuleStack=function(){var t=this;return p.map(this.RULE_STACK,function(e){return t.shortRuleNameToFullName(e)})},t.prototype.SAVE_ERROR=function(t){if(a.exceptions.isRecognitionException(t))return t.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:p.cloneArr(this.RULE_OCCURRENCE_STACK)},this._errors.push(t),t;throw Error("Trying to save an Error which is not a RecognitionException")},t.prototype.BACKTRACK=function(t,e){return function(){this.isBackTrackingStack.push(1);var n=this.saveRecogState();try{var r=t.call(this);return e(r)}catch(o){if(a.exceptions.isRecognitionException(o))return!1;throw o}finally{this.reloadRecogState(n),this.isBackTrackingStack.pop()}}},t.prototype.SKIP_TOKEN=function(){return this.inputIdx<=this._input.length-2?(this.consumeToken(),this.LA(1)):_},t.prototype.CONSUME=function(t){return this.CONSUME1(t)},t.prototype.CONSUME1=function(t){return this.consumeInternal(t,1)},t.prototype.CONSUME2=function(t){return this.consumeInternal(t,2)},t.prototype.CONSUME3=function(t){return this.consumeInternal(t,3)},t.prototype.CONSUME4=function(t){return this.consumeInternal(t,4)},t.prototype.CONSUME5=function(t){return this.consumeInternal(t,5)},t.prototype.SUBRULE=function(t,e){return void 0===e&&(e=[]),this.SUBRULE1(t,e)},t.prototype.SUBRULE1=function(t,e){return void 0===e&&(e=[]),t.call(this,1,e)},t.prototype.SUBRULE2=function(t,e){return void 0===e&&(e=[]),t.call(this,2,e)},t.prototype.SUBRULE3=function(t,e){return void 0===e&&(e=[]),t.call(this,3,e)},t.prototype.SUBRULE4=function(t,e){return void 0===e&&(e=[]),t.call(this,4,e)},t.prototype.SUBRULE5=function(t,e){return void 0===e&&(e=[]),t.call(this,5,e)},t.prototype.OPTION=function(t,e){return this.OPTION1.call(this,t,e)},t.prototype.OPTION1=function(t,e){return this.optionInternal(t,e,1)},t.prototype.OPTION2=function(t,e){return this.optionInternal(t,e,2)},t.prototype.OPTION3=function(t,e){return this.optionInternal(t,e,3)},t.prototype.OPTION4=function(t,e){return this.optionInternal(t,e,4)},t.prototype.OPTION5=function(t,e){return this.optionInternal(t,e,5)},t.prototype.OR=function(t,e){return this.OR1(t,e)},t.prototype.OR1=function(t,e){return this.orInternal(t,e,1)},t.prototype.OR2=function(t,e){return this.orInternal(t,e,2)},t.prototype.OR3=function(t,e){return this.orInternal(t,e,3)},t.prototype.OR4=function(t,e){return this.orInternal(t,e,4)},t.prototype.OR5=function(t,e){return this.orInternal(t,e,5)},t.prototype.MANY=function(t,e){return this.MANY1.call(this,t,e)},t.prototype.MANY1=function(t,e){this.manyInternal(this.MANY1,"MANY1",1,t,e)},t.prototype.MANY2=function(t,e){this.manyInternal(this.MANY2,"MANY2",2,t,e)},t.prototype.MANY3=function(t,e){this.manyInternal(this.MANY3,"MANY3",3,t,e)},t.prototype.MANY4=function(t,e){this.manyInternal(this.MANY4,"MANY4",4,t,e)},t.prototype.MANY5=function(t,e){this.manyInternal(this.MANY5,"MANY5",5,t,e)},t.prototype.MANY_SEP=function(t,e){return this.MANY_SEP1.call(this,t,e)},t.prototype.MANY_SEP1=function(t,e){return this.manySepFirstInternal(this.MANY_SEP1,"MANY_SEP1",1,t,e)},t.prototype.MANY_SEP2=function(t,e){return this.manySepFirstInternal(this.MANY_SEP2,"MANY_SEP2",2,t,e)},t.prototype.MANY_SEP3=function(t,e){return this.manySepFirstInternal(this.MANY_SEP3,"MANY_SEP3",3,t,e)},t.prototype.MANY_SEP4=function(t,e){return this.manySepFirstInternal(this.MANY_SEP4,"MANY_SEP4",4,t,e)},t.prototype.MANY_SEP5=function(t,e){return this.manySepFirstInternal(this.MANY_SEP5,"MANY_SEP5",5,t,e)},t.prototype.AT_LEAST_ONE=function(t,e,n){return this.AT_LEAST_ONE1.call(this,t,e,n)},t.prototype.AT_LEAST_ONE1=function(t,e,n){this.atLeastOneInternal(this.AT_LEAST_ONE1,"AT_LEAST_ONE1",1,t,e,n)},t.prototype.AT_LEAST_ONE2=function(t,e,n){this.atLeastOneInternal(this.AT_LEAST_ONE2,"AT_LEAST_ONE2",2,t,e,n)},t.prototype.AT_LEAST_ONE3=function(t,e,n){this.atLeastOneInternal(this.AT_LEAST_ONE3,"AT_LEAST_ONE3",3,t,e,n)},t.prototype.AT_LEAST_ONE4=function(t,e,n){this.atLeastOneInternal(this.AT_LEAST_ONE4,"AT_LEAST_ONE4",4,t,e,n)},t.prototype.AT_LEAST_ONE5=function(t,e,n){this.atLeastOneInternal(this.AT_LEAST_ONE5,"AT_LEAST_ONE5",5,t,e,n)},t.prototype.AT_LEAST_ONE_SEP=function(t,e,n){return this.AT_LEAST_ONE_SEP1.call(this,t,e,n)},t.prototype.AT_LEAST_ONE_SEP1=function(t,e,n){return this.atLeastOneSepFirstInternal(this.atLeastOneSepFirstInternal,"AT_LEAST_ONE_SEP1",1,t,e,n)},t.prototype.AT_LEAST_ONE_SEP2=function(t,e,n){return this.atLeastOneSepFirstInternal(this.atLeastOneSepFirstInternal,"AT_LEAST_ONE_SEP2",2,t,e,n)},t.prototype.AT_LEAST_ONE_SEP3=function(t,e,n){return this.atLeastOneSepFirstInternal(this.atLeastOneSepFirstInternal,"AT_LEAST_ONE_SEP3",3,t,e,n)},t.prototype.AT_LEAST_ONE_SEP4=function(t,e,n){return this.atLeastOneSepFirstInternal(this.atLeastOneSepFirstInternal,"AT_LEAST_ONE_SEP4",4,t,e,n)},t.prototype.AT_LEAST_ONE_SEP5=function(t,e,n){return this.atLeastOneSepFirstInternal(this.atLeastOneSepFirstInternal,"AT_LEAST_ONE_SEP5",5,t,e,n)},t.prototype.RULE=function(t,e,n){void 0===n&&(n=S);var r=u.validateRuleName(t,this.className);if(r=r.concat(u.validateRuleDoesNotAlreadyExist(t,this.definedRulesNames,this.className)),this.definedRulesNames.push(t),this.definitionErrors.push.apply(this.definitionErrors,r),this._productions.containsKey(t)){var o=i.getProductionsForClass(this.className),a=o.get(t);p.isUndefined(a)||this._productions.put(t,a)}else{var s=T.buildTopProduction(e.toString(),t,this.tokensMap);this._productions.put(t,s)}return this.defineRule(t,e,n)},t.prototype.OVERRIDE_RULE=function(t,e,n){void 0===n&&(n=S);var r=u.validateRuleName(t,this.className);r=r.concat(u.validateRuleIsOverridden(t,this.definedRulesNames,this.className)),this.definitionErrors.push.apply(this.definitionErrors,r);var o=i.getProductionOverriddenForClass(this.className);if(o.containsKey(t)){var a=i.getProductionsForClass(this.className);this._productions.put(t,a.get(t))}else{o.put(t,!0);var s=T.buildTopProduction(e.toString(),t,this.tokensMap);this._productions.put(t,s)}return this.defineRule(t,e,n)},t.prototype.ruleInvocationStateUpdate=function(t,e){this.RULE_OCCURRENCE_STACK.push(e),this.RULE_STACK.push(t)},t.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),0===this.RULE_STACK.length&&!this.isAtEndOfInput()){var t=this.LA(1);this.SAVE_ERROR(new a.exceptions.NotAllInputParsedException("Redundant input, expecting EOF but found: "+t.image,t))}},t.prototype.getTokenToInsert=function(t){var e;if(f.LazyToken.prototype.isPrototypeOf(t.prototype))e=new t(NaN,NaN,{orgText:"",lineToOffset:[]});else{if(!f.Token.prototype.isPrototypeOf(t.prototype))throw Error("non exhaustive match");e=new t("",NaN,NaN,NaN,NaN,NaN)}return e.isInsertedInRecovery=!0,e},t.prototype.canTokenTypeBeInsertedInRecovery=function(t){return!0},t.prototype.getMisMatchTokenErrorMessage=function(t,e){var n=f.hasTokenLabel(t),r=n?"--> "+f.tokenLabel(t)+" <--":"token of type --> "+f.tokenName(t)+" <--",o="Expecting "+r+" but found --> '"+e.image+"' <--";return o},t.prototype.getCurrentGrammarPath=function(t,e){var n=this.getHumanReadableRuleStack(),r=p.cloneArr(this.RULE_OCCURRENCE_STACK),o={ruleStack:n,occurrenceStack:r,lastTok:t,lastTokOccurrence:e};return o},t.prototype.getNextPossibleTokenTypes=function(t){var e=p.first(t.ruleStack),n=this.getGAstProductions(),r=n.get(e),o=new E.NextAfterTokenWalker(r,t).startWalking();return o},t.prototype.consumeInternal=function(t,e){return this.recoveryEnabled?this.consumeInternalWithTryCatch(t,e):this.consumeInternalOptimized(t)},t.prototype.consumeInternalWithTryCatch=function(t,e){try{return this.consumeInternalOptimized(t)}catch(n){if(!this.recoveryEnabled||"MismatchedTokenException"!==n.name||this.isBackTracking())throw n;var r=this.getFollowsForInRuleRecovery(t,e);try{return this.tryInRuleRecovery(t,r)}catch(o){throw o.name===y?n:o}}},t.prototype.NEXT_TOKEN=function(){return this.LA(1)},t.prototype.LA=function(t){return this._input.length<=this.inputIdx+t?_:this._input[this.inputIdx+t]},t.prototype.consumeToken=function(){this.inputIdx++},t.prototype.saveLexerState=function(){this.savedTokenIdx=this.inputIdx},t.prototype.restoreLexerState=function(){this.inputIdx=this.savedTokenIdx},t.prototype.resetLexerState=function(){this.inputIdx=-1},t.prototype.saveRecogState=function(){var t=this.errors,e=p.cloneArr(this.RULE_STACK);return{errors:t,lexerState:this.inputIdx,RULE_STACK:e}},t.prototype.reloadRecogState=function(t){this.errors=t.errors,this.inputIdx=t.lexerState,this.RULE_STACK=t.RULE_STACK},t.prototype.defineRule=function(t,e,n){function r(t){var n=e.apply(this,t);return this.ruleFinallyStateUpdate(),n}function o(t,n){try{return e.apply(this,t)}catch(r){if(n)for(var o=this.RULE_STACK.length;o>1;o--)this.ruleFinallyStateUpdate();var c=1===this.RULE_STACK.length,u=c||i&&!this.isBackTracking()&&this.recoveryEnabled;if(u&&a.exceptions.isRecognitionException(r)){var p=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(p))return r.resyncedTokens=this.reSyncTo(p),s();throw r}throw r}finally{this.ruleFinallyStateUpdate()}}var i=p.has(n,"resyncEnabled")?n.resyncEnabled:S.resyncEnabled,s=p.has(n,"recoveryValueFunc")?n.recoveryValueFunc:S.recoveryValueFunc,c=String(this.ruleShortNameIdx);this.ruleShortNameIdx++,this.shortRuleNameToFull.put(c,t);var u=function(t,e){void 0===t&&(t=1),this.ruleInvocationStateUpdate(c,t);var n=1===this.RULE_STACK.length;return this.recoveryEnabled||n?o.call(this,e,n):r.call(this,e)},l="ruleName";return u[l]=t,u},t.prototype.tryInRepetitionRecovery=function(t,e,n,r){var o=this,i=this.findReSyncTokenType();this.saveLexerState();for(var s=[],c=!1,u=this.LA(1),l=this.LA(1),f=function(){var t=o.getMisMatchTokenErrorMessage(r,u),e=new a.exceptions.MismatchedTokenException(t,u);e.resyncedTokens=p.dropRight(s),o.SAVE_ERROR(e)};!c;){if(l instanceof r)return void f();if(n.call(this))return f(),void t.apply(this,e);l instanceof i?c=!0:(l=this.SKIP_TOKEN(),this.addToResyncTokens(l,s))}this.restoreLexerState()},t.prototype.shouldInRepetitionRecoveryBeTried=function(t,e){return void 0!==t&&void 0!==e&&(!(this.LA(1)instanceof t)&&(!this.isBackTracking()&&!this.canPerformInRuleRecovery(t,this.getFollowsForInRuleRecovery(t,e))))},t.prototype.getFollowsForInRuleRecovery=function(t,e){var n=this.getCurrentGrammarPath(t,e),r=this.getNextPossibleTokenTypes(n);return r},t.prototype.tryInRuleRecovery=function(t,e){if(this.canRecoverWithSingleTokenInsertion(t,e)){var n=this.getTokenToInsert(t);return n}if(this.canRecoverWithSingleTokenDeletion(t)){var r=this.SKIP_TOKEN();return this.consumeToken(),r}throw new o("sad sad panda")},t.prototype.canPerformInRuleRecovery=function(t,e){return this.canRecoverWithSingleTokenInsertion(t,e)||this.canRecoverWithSingleTokenDeletion(t)},t.prototype.canRecoverWithSingleTokenInsertion=function(t,e){if(!this.canTokenTypeBeInsertedInRecovery(t))return!1;if(p.isEmpty(e))return!1;var n=this.LA(1),r=void 0!==p.find(e,function(t){return n instanceof t});return r},t.prototype.canRecoverWithSingleTokenDeletion=function(t){var e=this.LA(2)instanceof t;return e},t.prototype.isInCurrentRuleReSyncSet=function(t){var e=this.getCurrFollowKey(),n=this.getFollowSetFromFollowKey(e);return p.contains(n,t)},t.prototype.findReSyncTokenType=function(){for(var t=this.flattenFollowSet(),e=this.LA(1),n=2;;){var r=e.constructor;if(p.contains(t,r))return r;e=this.LA(n),n++}},t.prototype.getCurrFollowKey=function(){if(1===this.RULE_STACK.length)return I;var t=this.RULE_STACK.length-1,e=t,n=t-1;return{ruleName:this.shortRuleNameToFullName(this.RULE_STACK[t]),idxInCallingRule:this.RULE_OCCURRENCE_STACK[e],inRule:this.shortRuleNameToFullName(this.RULE_STACK[n])}},t.prototype.buildFullFollowKeyStack=function(){var t=this;return p.map(this.RULE_STACK,function(e,n){return 0===n?I:{ruleName:t.shortRuleNameToFullName(e),idxInCallingRule:t.RULE_OCCURRENCE_STACK[n],inRule:t.shortRuleNameToFullName(t.RULE_STACK[n-1])}})},t.prototype.flattenFollowSet=function(){var t=this,e=p.map(this.buildFullFollowKeyStack(),function(e){return t.getFollowSetFromFollowKey(e)});return p.flatten(e)},t.prototype.getFollowSetFromFollowKey=function(t){if(t===I)return[f.EOF];var e=t.ruleName+t.idxInCallingRule+d.IN+t.inRule;return i.getResyncFollowsForClass(this.className).get(e)},t.prototype.addToResyncTokens=function(t,e){return t instanceof f.EOF||e.push(t),e},t.prototype.reSyncTo=function(t){for(var e=[],n=this.LA(1);n instanceof t==!1;)n=this.SKIP_TOKEN(),this.addToResyncTokens(n,e);return p.dropRight(e)},t.prototype.attemptInRepetitionRecovery=function(t,e,n,r,o,i,a){var s=this.getKeyForAutomaticLookahead(r,a,o),c=this.firstAfterRepMap.get(s);if(void 0===c){var u=this.getCurrRuleFullName(),p=this.getGAstProductions().get(u),l=new i(p,o);c=l.startWalking(),this.firstAfterRepMap.put(s,c)}var h=c.token,T=c.occurrence,E=c.isEndOfRule;1===this.RULE_STACK.length&&E&&void 0===h&&(h=f.EOF,T=1),this.shouldInRepetitionRecoveryBeTried(h,T)&&this.tryInRepetitionRecovery(t,e,n,h)},t.prototype.optionInternal=function(t,e,n){var r=this.getLookaheadFuncForOption(n);if(void 0===e)e=t;else if(!t.call(this))return!1;return!!r.call(this)&&(e.call(this),!0)},t.prototype.atLeastOneInternal=function(t,e,n,r,o,i){var a=this,s=this.getLookaheadFuncForAtLeastOne(n);if(p.isFunction(o)){var c=s;s=function(){return r.call(a)&&c.call(a)}}else i=o,o=r;if(!s.call(this))throw this.raiseEarlyExitException(n,h.PROD_TYPE.REPETITION_MANDATORY,i);for(o.call(this);s.call(this);)o.call(this);this.attemptInRepetitionRecovery(t,[s,o,i],s,e,n,E.NextTerminalAfterAtLeastOneWalker,this.atLeastOneLookaheadKeys)},t.prototype.atLeastOneSepFirstInternal=function(t,e,n,r,o,i){var a=this,s=[],c=this.getLookaheadFuncForAtLeastOneSep(n);if(!c.call(this))throw this.raiseEarlyExitException(n,h.PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,i);o.call(this);for(var u=function(){return a.LA(1)instanceof r};u();)s.push(this.CONSUME(r)),o.call(this);return this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,n,r,u,o,s,this.atLeastOneSepLookaheadKeys,E.NextTerminalAfterAtLeastOneSepWalker],u,e,n,E.NextTerminalAfterAtLeastOneSepWalker,this.atLeastOneSepLookaheadKeys),s},t.prototype.manyInternal=function(t,e,n,r,o){var i=this,a=this.getLookaheadFuncForMany(n);if(void 0===o)o=r;else{var s=a;a=function(){return r.call(i)&&s.call(i)}}for(;a.call(this);)o.call(this);this.attemptInRepetitionRecovery(t,[a,o],a,e,n,E.NextTerminalAfterManyWalker,this.manyLookaheadKeys)},t.prototype.manySepFirstInternal=function(t,e,n,r,o){var i=this,a=[],s=this.getLookaheadFuncForManySep(n);if(s.call(this)){o.call(this);for(var c=function(){return i.LA(1)instanceof r};c();)a.push(this.CONSUME(r)),o.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,n,r,c,o,a,this.manySepLookaheadKeys,E.NextTerminalAfterManySepWalker],c,e,n,E.NextTerminalAfterManySepWalker,this.manySepLookaheadKeys)}return a},t.prototype.repetitionSepSecondInternal=function(t,e,n,r,o,i,a,s){for(;r();)i.push(this.CONSUME(n)),o.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,e,n,r,o,i,a,s],r,t,e,s,a)},t.prototype.orInternal=function(t,e,n){var r=this.getLookaheadFuncForOr(n,t),o=r.call(this,t);if(o!==-1){var i=t[o];return i.ALT.call(this)}this.raiseNoAltException(n,e)},t.prototype.consumeInternalOptimized=function(t){var e=this.LA(1);if(e instanceof t)return this.consumeToken(),e;var n=this.getMisMatchTokenErrorMessage(t,e);throw this.SAVE_ERROR(new a.exceptions.MismatchedTokenException(n,e))},t.prototype.getKeyForAutomaticLookahead=function(t,e,n){var r=e[n-1],o=this.RULE_STACK,i=o[o.length-1],a=r[i];return void 0===a&&(a=t+n+i,r[i]=a),a},t.prototype.getLookaheadFuncForOr=function(t,e){var n=this.getKeyForAutomaticLookahead(O,this.orLookaheadKeys,t),r=this.classLAFuncs.get(n);if(void 0===r){var o=this.getCurrRuleFullName(),i=this.getGAstProductions().get(o),a=p.some(e,function(t){return p.isFunction(t.GATE)});return r=h.buildLookaheadFuncForOr(t,i,this.maxLookahead,a),this.classLAFuncs.put(n,r),r}return r},t.prototype.getLookaheadFuncForOption=function(t){var e=this.getKeyForAutomaticLookahead(v,this.optionLookaheadKeys,t);return this.getLookaheadFuncFor(e,t,h.buildLookaheadForOption,this.maxLookahead)},t.prototype.getLookaheadFuncForMany=function(t){var e=this.getKeyForAutomaticLookahead(g,this.manyLookaheadKeys,t);return this.getLookaheadFuncFor(e,t,h.buildLookaheadForMany,this.maxLookahead)},t.prototype.getLookaheadFuncForManySep=function(t){var e=this.getKeyForAutomaticLookahead(N,this.manySepLookaheadKeys,t);return this.getLookaheadFuncFor(e,t,h.buildLookaheadForManySep,this.maxLookahead)},t.prototype.getLookaheadFuncForAtLeastOne=function(t){var e=this.getKeyForAutomaticLookahead(m,this.atLeastOneLookaheadKeys,t);return this.getLookaheadFuncFor(e,t,h.buildLookaheadForAtLeastOne,this.maxLookahead)},t.prototype.getLookaheadFuncForAtLeastOneSep=function(t){var e=this.getKeyForAutomaticLookahead(R,this.atLeastOneSepLookaheadKeys,t);return this.getLookaheadFuncFor(e,t,h.buildLookaheadForAtLeastOneSep,this.maxLookahead)},t.prototype.getLookaheadFuncFor=function(t,e,n,r){var o=this.classLAFuncs.get(t);if(void 0===o){var i=this.getCurrRuleFullName(),a=this.getGAstProductions().get(i);return o=n.apply(null,[e,a,r]),this.classLAFuncs.put(t,o),o}return o},t.prototype.raiseNoAltException=function(t,e){var n=" but found: '"+this.LA(1).image+"'";if(void 0===e){var r=this.getCurrRuleFullName(),o=this.getGAstProductions().get(r),i=h.getLookaheadPathsForOr(t,o,this.maxLookahead),s=p.reduce(i,function(t,e){return t.concat(e)},[]),c=p.map(s,function(t){return"["+p.map(t,function(t){return f.tokenLabel(t)}).join(",")+"]"});e="one of these possible Token sequences:\n  <"+c.join(" ,")+">"}throw this.SAVE_ERROR(new a.exceptions.NoViableAltException("Expecting: "+e+" "+n,this.LA(1)))},t.prototype.raiseEarlyExitException=function(t,e,n){var r=" but found: '"+this.LA(1).image+"'";if(void 0===n){var o=this.getCurrRuleFullName(),i=this.getGAstProductions().get(o),s=h.getLookaheadPathsForOptionalProd(t,i,e,this.maxLookahead),c=s[0],u=p.map(c,function(t){return"["+p.map(t,function(t){return f.tokenLabel(t)}).join(",")+"]"});n="expecting at least one iteration which starts with one of these possible Token sequences::\n  "+("<"+u.join(" ,")+">")}else n="Expecting at least one "+n;throw this.SAVE_ERROR(new a.exceptions.EarlyExitException(n+r,this.LA(1)))},t.NO_RESYNC=!1,t.DEFER_DEFINITION_ERRORS_HANDLING=!1,t}();e.Parser=P,o.prototype=Error.prototype},function(t,e,n){"use strict";function r(t){return l(t,e.CLASS_TO_GRAMMAR_PRODUCTIONS)}function o(t){return l(t,e.CLASS_TO_RESYNC_FOLLOW_SETS)}function i(t,n){e.CLASS_TO_RESYNC_FOLLOW_SETS.put(t,n)}function a(t){return l(t,e.CLASS_TO_LOOKAHEAD_FUNCS)}function s(t){return l(t,e.CLASS_TO_FIRST_AFTER_REPETITION)}function c(t){return l(t,e.CLASS_TO_PRODUCTION_OVERRIDEN)}function u(t){e.CLASS_TO_OR_LA_CACHE[t]=new Array(e.MAX_OCCURRENCE_INDEX),e.CLASS_TO_MANY_LA_CACHE[t]=new Array(e.MAX_OCCURRENCE_INDEX),e.CLASS_TO_MANY_SEP_LA_CACHE[t]=new Array(e.MAX_OCCURRENCE_INDEX),e.CLASS_TO_AT_LEAST_ONE_LA_CACHE[t]=new Array(e.MAX_OCCURRENCE_INDEX),e.CLASS_TO_AT_LEAST_ONE_SEP_LA_CACHE[t]=new Array(e.MAX_OCCURRENCE_INDEX),e.CLASS_TO_OPTION_LA_CACHE[t]=new Array(e.MAX_OCCURRENCE_INDEX),p(e.CLASS_TO_OR_LA_CACHE[t]),p(e.CLASS_TO_MANY_LA_CACHE[t]),p(e.CLASS_TO_MANY_SEP_LA_CACHE[t]),p(e.CLASS_TO_AT_LEAST_ONE_LA_CACHE[t]),p(e.CLASS_TO_AT_LEAST_ONE_SEP_LA_CACHE[t]),p(e.CLASS_TO_OPTION_LA_CACHE[t])}function p(t){for(var n=0;n<e.MAX_OCCURRENCE_INDEX;n++)t[n]=new h.HashTable}function l(t,e){var n=e.get(t);return void 0===n&&(e.put(t,new h.HashTable),n=e.get(t)),n}function f(){var e=T.filter(T.values(t.exports),function(t){return t instanceof h.HashTable});T.forEach(e,function(t){return t.clear()})}var h=n(3),T=n(4);e.CLASS_TO_DEFINITION_ERRORS=new h.HashTable,e.CLASS_TO_SELF_ANALYSIS_DONE=new h.HashTable,e.CLASS_TO_GRAMMAR_PRODUCTIONS=new h.HashTable,e.getProductionsForClass=r,e.CLASS_TO_RESYNC_FOLLOW_SETS=new h.HashTable,e.getResyncFollowsForClass=o,e.setResyncFollowsForClass=i,e.CLASS_TO_LOOKAHEAD_FUNCS=new h.HashTable,e.getLookaheadFuncsForClass=a,e.CLASS_TO_FIRST_AFTER_REPETITION=new h.HashTable,e.getFirstAfterRepForClass=s,e.CLASS_TO_PRODUCTION_OVERRIDEN=new h.HashTable,e.getProductionOverriddenForClass=c,e.CLASS_TO_OR_LA_CACHE=new h.HashTable,e.CLASS_TO_MANY_LA_CACHE=new h.HashTable,e.CLASS_TO_MANY_SEP_LA_CACHE=new h.HashTable,e.CLASS_TO_AT_LEAST_ONE_LA_CACHE=new h.HashTable,e.CLASS_TO_AT_LEAST_ONE_SEP_LA_CACHE=new h.HashTable,e.CLASS_TO_OPTION_LA_CACHE=new h.HashTable,e.MAX_OCCURRENCE_INDEX=5,e.initLookAheadKeyCache=u,e.clearCache=f},function(t,e,n){"use strict";function r(t){return o(t.constructor)}function o(t){var n=t.name;if(n)return n;var r=t[e.SPECIAL_NAME_CACHE_KEY];if(r)return r;var o=t.toString().match(c)[1];return i(t,o)||(t[e.SPECIAL_NAME_CACHE_KEY]=o),o}function i(t,e){var n=Object.getOwnPropertyDescriptor(t,u);return!(!s.isUndefined(n)&&!n.configurable)&&(Object.defineProperty(t,u,{enumerable:!1,configurable:!0,writable:!1,value:e}),!0)}var a=n(4),s=n(4);e.classNameFromInstance=r;var c=/^\s*function\s*(\S*)\s*\(/,u="name";e.SPECIAL_NAME_CACHE_KEY="CHEV_FUNC_NAME_CACHE666",e.functionName=o,e.defineNameProp=i;var p=function(){function t(){this._state={}}return t.prototype.keys=function(){return a.keys(this._state)},t.prototype.values=function(){return a.values(this._state)},t.prototype.put=function(t,e){this._state[t]=e},t.prototype.putAll=function(t){this._state=a.assign(this._state,t._state)},t.prototype.get=function(t){return this._state[t]},t.prototype.containsKey=function(t){return a.has(this._state,t)},t.prototype.clear=function(){this._state={}},t}();e.HashTable=p},function(t,e){"use strict";function n(t){return t&&0===t.length}function r(t){return Object.keys(t)}function o(t){for(var e=[],n=Object.keys(t),r=0;r<n.length;r++)e.push(t[n[r]]);return e}function i(t,e){for(var n=[],o=r(t),i=0;i<o.length;i++){var a=o[i];n.push(e.call(null,t[a],a))}return n}function a(t,e){for(var n=[],r=0;r<t.length;r++)n.push(e.call(null,t[r],r));return n}function s(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];Array.isArray(r)?e=e.concat(s(r)):e.push(r)}return e}function c(t){return n(t)?void 0:t[0]}function u(t){var e=t&&t.length;return e?t[e-1]:void 0}function p(t,e){if(Array.isArray(t))for(var n=0;n<t.length;n++)e.call(null,t[n],n);else{if(!k(t))throw Error("non exhaustive match");for(var o=r(t),n=0;n<o.length;n++){var i=o[n],a=t[i];e.call(null,a,i)}}}function l(t){return"string"==typeof t}function f(t){return void 0===t}function h(t){return t instanceof Function}function T(t,e){return void 0===e&&(e=1),t.slice(e,t.length)}function E(t,e){return void 0===e&&(e=1),t.slice(0,t.length-e)}function d(t,e){var n=[];if(Array.isArray(t))for(var r=0;r<t.length;r++){var o=t[r];e.call(null,o)&&n.push(o)}return n}function A(t,e){return d(t,function(t){return!e(t)})}function y(t,e){for(var n=Object.keys(t),r={},o=0;o<n.length;o++){var i=n[o],a=t[i];e(a)&&(r[i]=a)}return r}function _(t,e){return t.hasOwnProperty(e)}function O(t,e){return void 0!==m(t,function(t){return t===e})}function v(t){return a(t,function(t){return t})}function g(t){var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function m(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(e.call(null,r))return r}}function N(t,e,n){for(var r=Array.isArray(t)?t:o(t),i=n,a=0;a<r.length;a++)i=e.call(null,i,r[a],a);return i}function R(t){return A(t,function(t){return null===t||void 0===t})}function L(t,e){void 0===e&&(e=function(t){return t});var n=[];return N(t,function(t,r){var o=e(r);return O(n,o)?t:(n.push(o),t.concat(r))},[])}function S(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=[null],o=r.concat(e);return Function.bind.apply(t,o)}function I(t){return Array.isArray(t)}function P(t){return t instanceof RegExp}function k(t){return t instanceof Object}function x(t,e){for(var n=0;n<t.length;n++)if(!e(t[n],n))return!1;return!0}function C(t,e){return A(t,function(t){return O(e,t)})}function F(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function M(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1}function w(t,e){var n=v(t);return n.sort(function(t,n){return e(t)-e(n)}),n}function D(t,e){if(t.length!==e.length)throw Error("can't zipObject with different number of keys and values!");for(var n={},r=0;r<t.length;r++)n[t[r]]=e[r];return n}function U(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var o=0;o<e.length;o++)for(var i=e[o],a=r(i),s=0;s<a.length;s++){var c=a[s];t[c]=i[c]}return t}function b(t,e){var n={};return p(t,function(t){var r=e(t),o=n[r];o?o.push(t):n[r]=[t]}),n}function Y(t,e){for(var n=g(t),o=r(e),i=0;i<o.length;i++){var a=o[i],s=e[a];n[a]=s}return n}function K(){}e.isEmpty=n,e.keys=r,e.values=o,e.mapValues=i,e.map=a,e.flatten=s,e.first=c,e.last=u,e.forEach=p,e.isString=l,e.isUndefined=f,e.isFunction=h,e.drop=T,e.dropRight=E,e.filter=d,e.reject=A,e.pick=y,e.has=_,e.contains=O,e.cloneArr=v,e.cloneObj=g,e.find=m,e.reduce=N,e.compact=R,e.uniq=L,e.partial=S,
e.isArray=I,e.isRegExp=P,e.isObject=k,e.every=x,e.difference=C,e.some=F,e.indexOf=M,e.sortBy=w,e.zipObject=D,e.assign=U,e.groupBy=b,e.merge=Y,e.NOOP=K},function(t,e,n){"use strict";var r,o=n(4);!function(t){function e(t){return o.contains(l,t.name)}function n(t,e){this.name=s,this.message=t,this.token=e,this.resyncedTokens=[]}function r(t,e){this.name=c,this.message=t,this.token=e,this.resyncedTokens=[]}function i(t,e){this.name=p,this.message=t,this.token=e,this.resyncedTokens=[]}function a(t,e){this.name=u,this.message=t,this.token=e,this.resyncedTokens=[]}var s="MismatchedTokenException",c="NoViableAltException",u="EarlyExitException",p="NotAllInputParsedException",l=[s,c,u,p];Object.freeze(l),t.isRecognitionException=e,t.MismatchedTokenException=n,n.prototype=Error.prototype,t.NoViableAltException=r,r.prototype=Error.prototype,t.NotAllInputParsedException=i,i.prototype=Error.prototype,t.EarlyExitException=a,a.prototype=Error.prototype}(r=e.exceptions||(e.exceptions={}))},function(t,e,n){"use strict";function r(t){var e=new c(t);return e.resolveRefs(),e.errors}var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(1),a=n(7),s=n(4);e.resolveGrammar=r;var c=function(t){function e(e){t.call(this),this.nameToTopRule=e,this.errors=[]}return o(e,t),e.prototype.resolveRefs=function(){var t=this;s.forEach(this.nameToTopRule.values(),function(e){t.currTopLevel=e,e.accept(t)})},e.prototype.visitNonTerminal=function(t){var e=this.nameToTopRule.get(t.nonTerminalName);if(e)t.referencedRule=e;else{var n="Invalid grammar, reference to a rule which is not defined: ->"+t.nonTerminalName+"<-\ninside top level rule: ->"+this.currTopLevel.name+"<-";this.errors.push({message:n,type:i.ParserDefinitionErrorType.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:t.nonTerminalName})}},e}(a.gast.GAstVisitor);e.GastRefResolverVisitor=c},function(t,e,n){"use strict";var r,o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(4);!function(t){var e=function(){function t(t){this.definition=t,this.implicitOccurrenceIndex=!1}return t.prototype.accept=function(t){t.visit(this),i.forEach(this.definition,function(e){e.accept(t)})},t}();t.AbstractProduction=e;var n=function(t){function e(e,n,r){void 0===n&&(n=void 0),void 0===r&&(r=1),t.call(this,[]),this.nonTerminalName=e,this.referencedRule=n,this.occurrenceInParent=r}return o(e,t),Object.defineProperty(e.prototype,"definition",{get:function(){return void 0!==this.referencedRule?this.referencedRule.definition:[]},set:function(t){},enumerable:!0,configurable:!0}),e.prototype.accept=function(t){t.visit(this)},e}(e);t.NonTerminal=n;var r=function(t){function e(e,n,r){void 0===r&&(r=""),t.call(this,n),this.name=e,this.orgText=r}return o(e,t),e}(e);t.Rule=r;var a=function(t){function e(e){t.call(this,e)}return o(e,t),e}(e);t.Flat=a;var s=function(t){function e(e,n){void 0===n&&(n=1),t.call(this,e),this.occurrenceInParent=n}return o(e,t),e}(e);t.Option=s;var c=function(t){function e(e,n){void 0===n&&(n=1),t.call(this,e),this.occurrenceInParent=n}return o(e,t),e}(e);t.RepetitionMandatory=c;var u=function(t){function e(e,n,r){void 0===r&&(r=1),t.call(this,e),this.separator=n,this.occurrenceInParent=r}return o(e,t),e}(e);t.RepetitionMandatoryWithSeparator=u;var p=function(t){function e(e,n){void 0===n&&(n=1),t.call(this,e),this.occurrenceInParent=n}return o(e,t),e}(e);t.Repetition=p;var l=function(t){function e(e,n,r){void 0===r&&(r=1),t.call(this,e),this.separator=n,this.occurrenceInParent=r}return o(e,t),e}(e);t.RepetitionWithSeparator=l;var f=function(t){function e(e,n){void 0===n&&(n=1),t.call(this,e),this.occurrenceInParent=n}return o(e,t),e}(e);t.Alternation=f;var h=function(){function t(t,e){void 0===e&&(e=1),this.terminalType=t,this.occurrenceInParent=e,this.implicitOccurrenceIndex=!1}return t.prototype.accept=function(t){t.visit(this)},t}();t.Terminal=h;var T=function(){function t(){}return t.prototype.visit=function(t){if(t instanceof n)return this.visitNonTerminal(t);if(t instanceof a)return this.visitFlat(t);if(t instanceof s)return this.visitOption(t);if(t instanceof c)return this.visitRepetitionMandatory(t);if(t instanceof u)return this.visitRepetitionMandatoryWithSeparator(t);if(t instanceof l)return this.visitRepetitionWithSeparator(t);if(t instanceof p)return this.visitRepetition(t);if(t instanceof f)return this.visitAlternation(t);if(t instanceof h)return this.visitTerminal(t);if(t instanceof r)return this.visitRule(t);throw Error("non exhaustive match")},t.prototype.visitNonTerminal=function(t){},t.prototype.visitFlat=function(t){},t.prototype.visitOption=function(t){},t.prototype.visitRepetition=function(t){},t.prototype.visitRepetitionMandatory=function(t){},t.prototype.visitRepetitionMandatoryWithSeparator=function(t){},t.prototype.visitRepetitionWithSeparator=function(t){},t.prototype.visitAlternation=function(t){},t.prototype.visitTerminal=function(t){},t.prototype.visitRule=function(t){},t}();t.GAstVisitor=T}(r=e.gast||(e.gast={}))},function(t,e,n){"use strict";function r(t,e,n){var r=A.map(t,o),i=A.map(t,function(t){return l(t,t)}),a=y.map(t,h),s=y.map(t,function(t){return T(t,e,n)});return A.flatten(r.concat(i,a,s))}function o(t){var e=new R;t.accept(e);var n=e.allProductions,r=A.groupBy(n,a),o=A.pick(r,function(t){return t.length>1}),c=A.map(A.values(o),function(e){var n=A.first(e),r=i(e,t.name),o=v.getProductionDslName(n),a={message:r,type:_.ParserDefinitionErrorType.DUPLICATE_PRODUCTIONS,ruleName:t.name,dslName:o,occurrence:n.occurrenceInParent},c=s(n);return c&&(a.parameter=c),a});return c}function i(t,e){var n=A.first(t),r=n.occurrenceInParent,o=v.getProductionDslName(n),i=s(n),a="->"+o+"<- with occurrence index: ->"+r+"<-\n                  "+(i?"and argument: "+i:"")+"\n                  appears more than once ("+t.length+" times) in the top level rule: "+e+".\n                  "+(1===r?"note that "+o+" and "+o+"1 both have the same occurrence index 1}":"")+"}\n                  to fix this make sure each usage of "+o+" "+(i?"with the argument: "+i:"")+"\n                  in the rule "+e+" has a different occurrence index (1-5), as that combination acts as a unique\n                  position key in the grammar, which is needed by the parsing engine.";return a=a.replace(/[ \t]+/g," "),a=a.replace(/\s\s+/g,"\n")}function a(t){return v.getProductionDslName(t)+"_#_"+t.occurrenceInParent+"_#_"+s(t)}function s(t){return t instanceof O.gast.Terminal?g.tokenName(t.terminalType):t instanceof O.gast.NonTerminal?t.nonTerminalName:""}function c(t,e){var n,r=[];return t.match(L)||(n="Invalid Grammar rule name: ->"+t+"<- it must match the pattern: ->"+L.toString()+"<-",r.push({message:n,type:_.ParserDefinitionErrorType.INVALID_RULE_NAME,ruleName:t})),r}function u(t,e,n){var r,o=[];return A.contains(e,t)&&(r="Duplicate definition, rule: ->"+t+"<- is already defined in the grammar: ->"+n+"<-",o.push({message:r,type:_.ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:t})),o}function p(t,e,n){var r,o=[];return A.contains(e,t)||(r="Invalid rule override, rule: ->"+t+"<- cannot be overridden in the grammar: ->"+n+"<-as it is not defined in any of the super grammars ",o.push({message:r,type:_.ParserDefinitionErrorType.INVALID_RULE_OVERRIDE,ruleName:t})),o}function l(t,e,n){void 0===n&&(n=[]);var r=[],o=f(e.definition);if(A.isEmpty(o))return[];var i=t.name,a=A.contains(o,t),s=A.map(n,function(t){return t.name}),c=i+" --> "+s.concat([i]).join(" --> ");if(a){var u="Left Recursion found in grammar.\n"+("rule: <"+i+"> can be invoked from itself (directly or indirectly)\n")+("without consuming any Tokens. The grammar path that causes this is: \n "+c+"\n")+" To fix this refactor your grammar to remove the left recursion.\nsee: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring.";r.push({message:u,type:_.ParserDefinitionErrorType.LEFT_RECURSION,ruleName:i})}var p=A.difference(o,n.concat([t])),h=A.map(p,function(e){var r=A.cloneArr(n);return r.push(e),l(t,e,r)});return r.concat(A.flatten(h))}function f(t){var e=[];if(A.isEmpty(t))return e;var n=A.first(t);if(n instanceof O.gast.NonTerminal)e.push(n.referencedRule);else if(n instanceof O.gast.Flat||n instanceof O.gast.Option||n instanceof O.gast.RepetitionMandatory||n instanceof O.gast.RepetitionMandatoryWithSeparator||n instanceof O.gast.RepetitionWithSeparator||n instanceof O.gast.Repetition)e=e.concat(f(n.definition));else if(n instanceof O.gast.Alternation)e=A.flatten(A.map(n.definition,function(t){return f(t.definition)}));else if(!(n instanceof O.gast.Terminal))throw Error("non exhaustive match");var r=v.isOptionalProd(n),o=t.length>1;if(r&&o){var i=A.drop(t);return e.concat(f(i))}return e}function h(t){var e=new S;t.accept(e);var n=e.alternations,r=A.reduce(n,function(e,n){var r=A.dropRight(n.definition),o=A.map(r,function(e,r){return A.isEmpty(m.first(e))?{message:"Ambiguous empty alternative: <"+(r+1)+">"+(" in <OR"+n.occurrenceInParent+"> inside <"+t.name+"> Rule.\n")+"Only the last alternative may be an empty alternative.",type:_.ParserDefinitionErrorType.NONE_LAST_EMPTY_ALT,ruleName:t.name,occurrence:n.occurrenceInParent,alternative:r+1}:null});return e.concat(A.compact(o))},[]);return r}function T(t,e,n){var r=new S;t.accept(r);var o=r.alternations,i=n[t.name];i&&(o=y.reject(o,function(t){return i[v.getProductionDslName(t)+t.occurrenceInParent]}));var a=A.reduce(o,function(n,r){var o=r.occurrenceInParent,i=N.getLookaheadPathsForOr(o,t,e),a=E(i),s=A.map(a,function(e){var n=y.map(e.alts,function(t){return t+1}),i=y.map(e.path,function(t){return g.tokenLabel(t)}).join(", "),a="Ambiguous alternatives: <"+n.join(" ,")+"> in <OR"+o+">"+(" inside <"+t.name+"> Rule,\n")+("<"+i+"> may appears as a prefix path in all these alternatives.\n");return a+="To Resolve this, try one of of the following: \n1. Refactor your grammar to be LL(K) for the current value of k (by default k=5)\n2. Increase the value of K for your grammar by providing a larger 'maxLookahead' value in the parser's config\n3. This issue can be ignored (if you know what you are doing...), see http://sap.github.io/chevrotain/documentation/0_9_0/interfaces/iparserconfig.html for\n",{message:a,type:_.ParserDefinitionErrorType.AMBIGUOUS_ALTS,ruleName:t.name,occurrence:r.occurrenceInParent,alternatives:[e.alts]}});return n.concat(s)},[]);return a}function E(t){var e=[],n=y.reduce(t,function(n,r,o){return y.forEach(r,function(r){var i=[o];y.forEach(t,function(t,e){o!==e&&N.containsPath(t,r)&&i.push(e)}),i.length>1&&!N.containsPath(e,r)&&(e.push(r),n.push({alts:i,path:r}))}),n},[]);return n}var d=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},A=n(4),y=n(4),_=n(1),O=n(7),v=n(9),g=n(10),m=n(14),N=n(15);e.validateGrammar=r,e.identifyProductionForDuplicates=a;var R=function(t){function e(){t.apply(this,arguments),this.allProductions=[]}return d(e,t),e.prototype.visitNonTerminal=function(t){this.allProductions.push(t)},e.prototype.visitOption=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e.prototype.visitAlternation=function(t){this.allProductions.push(t)},e.prototype.visitTerminal=function(t){this.allProductions.push(t)},e}(O.gast.GAstVisitor);e.OccurrenceValidationCollector=R;var L=/^[a-zA-Z_]\w*$/;e.validateRuleName=c,e.validateRuleDoesNotAlreadyExist=u,e.validateRuleIsOverridden=p,e.validateNoLeftRecursion=l,e.getFirstNoneTerminal=f;var S=function(t){function e(){t.apply(this,arguments),this.alternations=[]}return d(e,t),e.prototype.visitAlternation=function(t){this.alternations.push(t)},e}(O.gast.GAstVisitor);e.validateEmptyOrAlternative=h,e.validateAmbiguousAlternationAlternatives=T},function(t,e,n){"use strict";function r(t){return t instanceof u.gast.Flat||t instanceof u.gast.Option||t instanceof u.gast.Repetition||t instanceof u.gast.RepetitionMandatory||t instanceof u.gast.RepetitionMandatoryWithSeparator||t instanceof u.gast.RepetitionWithSeparator||t instanceof u.gast.Terminal||t instanceof u.gast.Rule}function o(t,e){void 0===e&&(e=[]);var n=t instanceof u.gast.Option||t instanceof u.gast.Repetition||t instanceof u.gast.RepetitionWithSeparator;return!!n||(t instanceof u.gast.Alternation?p.some(t.definition,function(t){return o(t,e)}):!(t instanceof u.gast.NonTerminal&&p.contains(e,t))&&(t instanceof u.gast.AbstractProduction&&(t instanceof u.gast.NonTerminal&&e.push(t),p.every(t.definition,function(t){return o(t,e)}))))}function i(t){return t instanceof u.gast.Alternation}function a(t){if(t instanceof u.gast.NonTerminal)return"SUBRULE";if(t instanceof u.gast.Option)return"OPTION";if(t instanceof u.gast.Alternation)return"OR";if(t instanceof u.gast.RepetitionMandatory)return"AT_LEAST_ONE";if(t instanceof u.gast.RepetitionMandatoryWithSeparator)return"AT_LEAST_ONE_SEP";if(t instanceof u.gast.RepetitionWithSeparator)return"MANY_SEP";if(t instanceof u.gast.Repetition)return"MANY";if(t instanceof u.gast.Terminal)return"CONSUME";throw Error("non exhaustive match")}function s(t){var e=new l;return e.visit(t)}var c=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},u=n(7),p=n(4);e.isSequenceProd=r,e.isOptionalProd=o,e.isBranchingProd=i,e.getProductionDslName=a;var l=function(t){function e(){t.apply(this,arguments)}return c(e,t),e.prototype.visitNonTerminal=function(t){return new u.gast.NonTerminal(t.nonTerminalName,(void 0),t.occurrenceInParent)},e.prototype.visitFlat=function(t){var e=this,n=p.map(t.definition,function(t){return e.visit(t)});return new u.gast.Flat(n)},e.prototype.visitOption=function(t){var e=this,n=p.map(t.definition,function(t){return e.visit(t)});return new u.gast.Option(n,t.occurrenceInParent)},e.prototype.visitRepetition=function(t){var e=this,n=p.map(t.definition,function(t){return e.visit(t)});return new u.gast.Repetition(n,t.occurrenceInParent)},e.prototype.visitRepetitionMandatory=function(t){var e=this,n=p.map(t.definition,function(t){return e.visit(t)});return new u.gast.RepetitionMandatory(n,t.occurrenceInParent)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){var e=this,n=p.map(t.definition,function(t){return e.visit(t)});return new u.gast.RepetitionMandatoryWithSeparator(n,t.separator,t.occurrenceInParent)},e.prototype.visitRepetitionWithSeparator=function(t){var e=this,n=p.map(t.definition,function(t){return e.visit(t)});return new u.gast.RepetitionWithSeparator(n,t.separator,t.occurrenceInParent)},e.prototype.visitAlternation=function(t){var e=this,n=p.map(t.definition,function(t){return e.visit(t)});return new u.gast.Alternation(n,t.occurrenceInParent)},e.prototype.visitTerminal=function(t){return new u.gast.Terminal(t.terminalType,t.occurrenceInParent)},e.prototype.visitRule=function(t){var e=this,n=p.map(t.definition,function(t){return e.visit(t)});return new u.gast.Rule(t.name,n,t.orgText)},e}(u.gast.GAstVisitor);e.cloneProduction=s},function(t,e,n){"use strict";function r(t){return o(t)?t.LABEL:i(t)}function o(t){return u.isString(t.LABEL)&&""!==t.LABEL}function i(t){return u.isString(t.tokenName)?t.tokenName:p.functionName(t)}function a(t,e,n){return void 0===e&&(e=void 0),void 0===n&&(n=T),s(t,e,n)}function s(t,e,n){void 0===e&&(e=void 0),void 0===n&&(n=h);var r;u.isRegExp(e)||e===l.Lexer.SKIPPED||e===l.Lexer.NA?r=e:u.isFunction(e)&&(n=e,r=void 0);var o=function(){n.apply(this,arguments)};return o=u.assign(o,n),p.defineNameProp(o,t)||(o.tokenName=t),o.prototype=Object.create(n.prototype),o.prototype.constructor=o,u.isUndefined(r)||(o.PATTERN=r),o}var c=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},u=n(4),p=n(3),l=n(11),f=n(13);e.tokenLabel=r,e.hasTokenLabel=o,e.tokenName=i,e.extendLazyToken=a,e.extendToken=s;var h=function(){function t(t,e,n,r,o,i){void 0===o&&(o=n),void 0===i&&(i=r+t.length-1),this.image=t,this.startOffset=e,this.startLine=n,this.startColumn=r,this.endLine=o,this.endColumn=i,this.isInsertedInRecovery=!1}return Object.defineProperty(t.prototype,"endOffset",{get:function(){return this.startOffset+this.image.length-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"offset",{get:function(){return this.startOffset},set:function(t){this.startOffset=t},enumerable:!0,configurable:!0}),t.LABEL=void 0,t}();e.Token=h;var T=function(){function t(t,e,n){this.startOffset=t,this.endOffset=e,this.cacheData=n}return Object.defineProperty(t.prototype,"image",{get:function(){return this.isInsertedInRecovery?"":this.cacheData.orgText.substring(this.startOffset,this.endOffset+1)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startLine",{get:function(){return this.isInsertedInRecovery?NaN:(this.ensureLineDataProcessing(),f.getStartLineFromLineToOffset(this.startOffset,this.cacheData.lineToOffset))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startColumn",{get:function(){return this.isInsertedInRecovery?NaN:(this.ensureLineDataProcessing(),f.getStartColumnFromLineToOffset(this.startOffset,this.cacheData.lineToOffset))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endLine",{get:function(){return this.isInsertedInRecovery?NaN:(this.ensureLineDataProcessing(),f.getEndLineFromLineToOffset(this.endOffset,this.cacheData.lineToOffset))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endColumn",{get:function(){return this.isInsertedInRecovery?NaN:(this.ensureLineDataProcessing(),f.getEndColumnFromLineToOffset(this.endOffset,this.cacheData.lineToOffset))},enumerable:!0,configurable:!0}),t.prototype.ensureLineDataProcessing=function(){u.isEmpty(this.cacheData.lineToOffset)&&f.fillUpLineToOffset(this.cacheData.lineToOffset,this.cacheData.orgText)},t.LABEL=void 0,t}();e.LazyToken=T;var E=function(t){function e(){t.call(this,"",NaN,NaN,NaN,NaN,NaN)}return c(e,t),e}(h);e.VirtualToken=E;var d=function(t){function e(){t.apply(this,arguments)}return c(e,t),e}(E);e.EOF=d},function(t,e,n){"use strict";var r=n(12),o=n(4),i=n(13);!function(t){t[t.MISSING_PATTERN=0]="MISSING_PATTERN",t[t.INVALID_PATTERN=1]="INVALID_PATTERN",t[t.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",t[t.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",t[t.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",t[t.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",t[t.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",t[t.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",t[t.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",t[t.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",t[t.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",t[t.LEXER_DEFINITION_CANNOT_MIX_LAZY_AND_NOT_LAZY=11]="LEXER_DEFINITION_CANNOT_MIX_LAZY_AND_NOT_LAZY"}(e.LexerDefinitionErrorType||(e.LexerDefinitionErrorType={}));var a=(e.LexerDefinitionErrorType,function(){function t(t,e){var n=this;void 0===e&&(e=!1),this.lexerDefinition=t,this.lexerDefinitionErrors=[],this.modes=[],this.allPatterns={},this.patternIdxToClass={},this.patternIdxToGroup={},this.patternIdxToLongerAltIdx={},this.patternIdxToCanLineTerminator={},this.patternIdxToPushMode={},this.patternIdxToPopMode={},this.emptyGroups={};var i;o.isArray(t)?(i={modes:{}},i.modes[r.DEFAULT_MODE]=o.cloneArr(t),i[r.DEFAULT_MODE]=r.DEFAULT_MODE):i=o.cloneObj(t),this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(r.performRuntimeChecks(i)),i.modes=i.modes?i.modes:{},o.forEach(i.modes,function(t,e){i.modes[e]=o.reject(t,function(t){return o.isUndefined(t)})});var a=o.keys(i.modes);o.forEach(i.modes,function(t,e){if(n.modes.push(e),n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(r.validatePatterns(t,a)),o.isEmpty(n.lexerDefinitionErrors)){var i=r.analyzeTokenClasses(t);n.allPatterns[e]=i.allPatterns,n.patternIdxToClass[e]=i.patternIdxToClass,n.patternIdxToGroup[e]=i.patternIdxToGroup,n.patternIdxToLongerAltIdx[e]=i.patternIdxToLongerAltIdx,n.patternIdxToCanLineTerminator[e]=i.patternIdxToCanLineTerminator,n.patternIdxToPushMode[e]=i.patternIdxToPushMode,n.patternIdxToPopMode[e]=i.patternIdxToPopMode,n.emptyGroups=o.merge(n.emptyGroups,i.emptyGroups)}}),this.defaultMode=i.defaultMode;var s=o.flatten(o.mapValues(i.modes,function(t){return t})),c=r.checkLazyMode(s);if(this.isLazyTokenMode=c.isLazy,this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(c.errors),!o.isEmpty(this.lexerDefinitionErrors)&&!e){var u=o.map(this.lexerDefinitionErrors,function(t){return t.message}),p=u.join("-----------------------\n");throw new Error("Errors detected in definition of Lexer:\n"+p)}}return t.prototype.tokenize=function(t,e){if(void 0===e&&(e=this.defaultMode),!o.isEmpty(this.lexerDefinitionErrors)){var n=o.map(this.lexerDefinitionErrors,function(t){return t.message}),r=n.join("-----------------------\n");throw new Error("Unable to Tokenize because Errors detected in definition of Lexer:\n"+r)}return this.isLazyTokenMode?this.tokenizeInternalLazy(t,e):this.tokenizeInternal(t,e)},t.prototype.tokenizeInternal=function(t,e){function n(t){b.push(t),k=this.allPatterns[t],x=k.length,C=this.patternIdxToLongerAltIdx[t],F=this.patternIdxToGroup[t],M=this.patternIdxToClass[t],w=this.patternIdxToCanLineTerminator[t],D=this.patternIdxToPushMode[t],U=this.patternIdxToPopMode[t]}var i,a,s,c,u,p,l,f,h,T,E,d,A,y,_,O,v,g=this,m=t,N=0,R=[],L=[],S=1,I=1,P=o.cloneObj(this.emptyGroups),k=[],x=0,C=[],F=[],M=[],w=[],D=[],U=[],b=[],Y=function(t){if(1===b.length){var e="Unable to pop Lexer Mode after encountering Token ->"+t.image+"<- The Mode Stack is empty";L.push({line:t.startLine,column:t.startColumn,length:t.image.length,message:e})}else{b.pop();var n=o.last(b);k=g.allPatterns[n],x=k.length,C=g.patternIdxToLongerAltIdx[n],F=g.patternIdxToGroup[n],M=g.patternIdxToClass[n],w=g.patternIdxToCanLineTerminator[n],D=g.patternIdxToPushMode[n],U=g.patternIdxToPopMode[n]}};for(n.call(this,e);t.length>0;){for(i=null,a=0;a<x;a++)if(i=k[a].exec(t),null!==i){u=C[a],u&&(c=k[u].exec(t),c&&c[0].length>i[0].length&&(i=c,a=u));break}if(null!==i){if(p=i[0],l=p.length,f=F[a],void 0!==f&&(h=M[a],T=new h(p,N,S,I),"default"===f?R.push(T):P[f].push(T)),t=t.slice(l),N+=l,I+=l,w[a]){var K=r.countLineTerminators(p);if(0!==K){for(S+=K,_=l-1;_>=0&&(A=p.charCodeAt(_),13!==A&&10!==A);)_--;I=l-_,void 0!==f&&(v=_===l-1,d=v?-1:0,1===K&&v||(T.endLine=S+d,T.endColumn=I-1+-d))}}U[a]&&Y(T),D[a]&&n.call(this,D[a])}else{for(var H=N,W=S,G=I,j=!1;!j&&t.length>0;)for(y=t.charCodeAt(0),10===y||13===y&&(1===t.length||t.length>1&&10!==t.charCodeAt(1))?(S++,I=1):I++,t=t.substr(1),N++,s=0;s<k.length&&!(j=k[s].test(t));s++);E=N-H,O="unexpected character: ->"+m.charAt(H)+"<- at offset: "+H+","+(" skipped "+(N-H)+" characters."),L.push({line:W,column:G,length:E,message:O})}}return{tokens:R,groups:P,errors:L}},t.prototype.tokenizeInternalLazy=function(t,e){function n(t){C.push(t),N=this.allPatterns[t],R=N.length,L=this.patternIdxToLongerAltIdx[t],S=this.patternIdxToGroup[t],I=this.patternIdxToClass[t],P=this.patternIdxToPushMode[t],k=this.patternIdxToPopMode[t]}var r,a,s,c,u,p,l,f,h,T,E,d,A,y=this,_=t,O=0,v=[],g=[],m=o.cloneObj(this.emptyGroups),N=[],R=0,L=[],S=[],I=[],P=[],k=[],x={orgText:t,lineToOffset:[]},C=[],F=function(t){if(1===C.length){var e="Unable to pop Lexer Mode after encountering Token ->"+t.image+"<- The Mode Stack is empty";g.push({line:t.startLine,column:t.startColumn,length:t.image.length,message:e})}else{C.pop();var n=o.last(C);N=y.allPatterns[n],R=N.length,L=y.patternIdxToLongerAltIdx[n],S=y.patternIdxToGroup[n],I=y.patternIdxToClass[n],P=y.patternIdxToPushMode[n],k=y.patternIdxToPopMode[n]}};for(n.call(this,e);t.length>0;){for(r=null,a=0;a<R;a++)if(r=N[a].exec(t),null!==r){u=L[a],u&&(c=N[u].exec(t),c&&c[0].length>r[0].length&&(r=c,a=u));break}if(null!==r)p=r[0],l=p.length,f=S[a],void 0!==f&&(h=I[a],T=new h(O,O+l-1,x),"default"===f?v.push(T):m[f].push(T)),t=t.slice(l),O+=l,k[a]&&F(T),P[a]&&n.call(this,P[a]);else{for(var M=O,w=!1;!w&&t.length>0;)for(d=t.charCodeAt(0),t=t.substr(1),O++,s=0;s<N.length&&!(w=N[s].test(t));s++);E=O-M,A="unexpected character: ->"+_.charAt(M)+"<- at offset: "+M+","+(" skipped "+(O-M)+" characters."),o.isEmpty(x.lineToOffset)&&i.fillUpLineToOffset(x.lineToOffset,x.orgText);var D=i.getStartLineFromLineToOffset(M,x.lineToOffset),U=i.getStartColumnFromLineToOffset(M,x.lineToOffset);g.push({line:D,column:U,length:E,message:A})}}return{tokens:v,groups:m,errors:g}},t.SKIPPED={description:"This marks a skipped Token pattern, this means each token identified by it willbe consumed and then throw into oblivion, this can be used to for example: skip whitespace."},t.NA=/NOT_APPLICABLE/,t}());e.Lexer=a},function(t,e,n){"use strict";function r(t){var e=_.reject(t,function(t){return t[O]===y.Lexer.NA}),n=_.map(e,function(t){return f(t[O])}),r=_.zipObject(n,e),o=_.map(n,function(t){return r[t.toString()]}),i=_.map(e,function(t){var e=t.GROUP;if(e!==y.Lexer.SKIPPED){if(_.isString(e))return e;if(_.isUndefined(e))return"default";throw Error("non exhaustive match")}}),a=_.map(e,function(t){var n=t.LONGER_ALT;if(n){var r=_.indexOf(e,n);return r}}),s=_.map(e,function(t){return t.PUSH_MODE}),c=_.map(e,function(t){return _.has(t,"POP_MODE")}),u=_.map(n,function(t){return/\\n|\\r|\\s/g.test(t.source)}),p=_.reduce(e,function(t,e){var n=e.GROUP;return _.isString(n)&&(t[n]=[]),t},{});return{allPatterns:n,patternIdxToClass:o,patternIdxToGroup:i,patternIdxToLongerAltIdx:a,patternIdxToCanLineTerminator:u,patternIdxToPushMode:s,patternIdxToPopMode:c,emptyGroups:p}}function o(t,e){var n=[],r=i(t),o=r.valid;n=n.concat(r.errors);var f=a(o);return o=f.valid,n=n.concat(f.errors),n=n.concat(s(o)),n=n.concat(c(o)),n=n.concat(u(o)),n=n.concat(p(o)),n=n.concat(l(o,e))}function i(t){var e=_.filter(t,function(t){return!_.has(t,O)}),n=_.map(e,function(t){return{message:"Token class: ->"+A.tokenName(t)+"<- missing static 'PATTERN' property",type:y.LexerDefinitionErrorType.MISSING_PATTERN,tokenClasses:[t]}}),r=_.difference(t,e);return{errors:n,valid:r}}function a(t){var e=_.filter(t,function(t){var e=t[O];return!_.isRegExp(e)}),n=_.map(e,function(t){return{message:"Token class: ->"+A.tokenName(t)+"<- static 'PATTERN' can only be a RegExp",type:y.LexerDefinitionErrorType.INVALID_PATTERN,tokenClasses:[t]}}),r=_.difference(t,e);return{errors:n,valid:r}}function s(t){var e=_.filter(t,function(t){var e=t[O];return v.test(e.source)}),n=_.map(e,function(t){return{message:"Token class: ->"+A.tokenName(t)+"<- static 'PATTERN' cannot contain end of input anchor '$'",type:y.LexerDefinitionErrorType.EOI_ANCHOR_FOUND,tokenClasses:[t]}});return n}function c(t){var e=_.filter(t,function(t){var e=t[O];return e instanceof RegExp&&(e.multiline||e.global)}),n=_.map(e,function(t){return{message:"Token class: ->"+A.tokenName(t)+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:y.LexerDefinitionErrorType.UNSUPPORTED_FLAGS_FOUND,tokenClasses:[t]}});return n}function u(t){var e=[],n=_.map(t,function(n){return _.reduce(t,function(t,r){return n.PATTERN.source!==r.PATTERN.source||_.contains(e,r)||r.PATTERN===y.Lexer.NA?t:(e.push(r),t.push(r),t)},[])});n=_.compact(n);var r=_.filter(n,function(t){return t.length>1}),o=_.map(r,function(t){var e=_.map(t,function(t){return A.tokenName(t)}),n=_.first(t).PATTERN;return{message:"The same RegExp pattern ->"+n+"<-"+("has been used in all the following classes: "+e.join(", ")+" <-"),type:y.LexerDefinitionErrorType.DUPLICATE_PATTERNS_FOUND,tokenClasses:t}});return o}function p(t){var e=_.filter(t,function(t){if(!_.has(t,"GROUP"))return!1;var e=t.GROUP;return e!==y.Lexer.SKIPPED&&e!==y.Lexer.NA&&!_.isString(e)}),n=_.map(e,function(t){return{message:"Token class: ->"+A.tokenName(t)+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:y.LexerDefinitionErrorType.INVALID_GROUP_TYPE_FOUND,tokenClasses:[t]}});return n}function l(t,e){var n=_.filter(t,function(t){return void 0!==t.PUSH_MODE&&!_.contains(e,t.PUSH_MODE)}),r=_.map(n,function(t){var e="Token class: ->"+A.tokenName(t)+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+t.PUSH_MODE+"<-which does not exist";return{message:e,type:y.LexerDefinitionErrorType.PUSH_MODE_DOES_NOT_EXIST,tokenClasses:[t]}});return r}function f(t){var e=t.ignoreCase?"i":"";return new RegExp("^(?:"+t.source+")",e)}function h(t){for(var e=0,n=0;n<t.length;){var r=t.charCodeAt(n);10===r?e++:13===r&&(n!==t.length-1&&10===t.charCodeAt(n+1)||e++),n++}return e}function T(t){var n=[];return _.has(t,e.DEFAULT_MODE)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+e.DEFAULT_MODE+"> property in its definition\n",type:y.LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),_.has(t,e.MODES)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+e.MODES+"> property in its definition\n",type:y.LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),_.has(t,e.MODES)&&_.has(t,e.DEFAULT_MODE)&&!_.has(t.modes,t.defaultMode)&&n.push({message:"A MultiMode Lexer cannot be initialized with a "+e.DEFAULT_MODE+": <"+t.defaultMode+">which does not exist\n",type:y.LexerDefinitionErrorType.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),_.has(t,e.MODES)&&_.forEach(t.modes,function(t,e){_.forEach(t,function(t,r){_.isUndefined(t)&&n.push({message:"A Lexer cannot be initialized using an undefined Token Class. Mode:"+("<"+e+"> at index: <"+r+">\n"),type:y.LexerDefinitionErrorType.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})})}),n}function E(t){return A.LazyToken.prototype.isPrototypeOf(t.prototype)}function d(t){var e=[],n=_.uniq(t,function(t){return A.tokenName(t)}),r=_.every(n,function(t){return E(t)}),o=_.every(n,function(t){return!E(t)});if(!r&&!o){var i=_.filter(n,function(t){return E(t)}),a=_.map(i,A.tokenName),s=a.join("\n\t"),c=_.filter(n,function(t){return!E(t)}),u=_.map(c,A.tokenName),p=u.join("\n\t");e.push({message:"A Lexer cannot be defined using a mix of both Lazy and Non-Lazy Tokens:\nLazy Tokens:\n\t"+s+"\nNon-Lazy Tokens:\n\t"+p,type:y.LexerDefinitionErrorType.LEXER_DEFINITION_CANNOT_MIX_LAZY_AND_NOT_LAZY})}return{isLazy:r,errors:e}}var A=n(10),y=n(11),_=n(4),O="PATTERN";e.DEFAULT_MODE="defaultMode",e.MODES="modes",e.analyzeTokenClasses=r,e.validatePatterns=o,e.findMissingPatterns=i,e.findInvalidPatterns=a;var v=/[^\\][\$]/;e.findEndOfInputAnchor=s,e.findUnsupportedFlags=c,e.findDuplicatePatterns=u,e.findInvalidGroupType=p,e.findModesThatDoNotExist=l,e.addStartOfInput=f,e.countLineTerminators=h,e.performRuntimeChecks=T,e.checkLazyMode=d},function(t,e){"use strict";function n(t,e){var n=0,r=0;for(t.push(0);r<e.length;){var o=e.charCodeAt(r);10===o?(n++,t.push(r+1)):13===o&&(r!==e.length-1&&10===e.charCodeAt(r+1)?(t.push(r+2),r++):(n++,t.push(r+1))),r++}t.push(1/0)}function r(t,e){return s(t,e)}function o(t,e){return s(t,e)}function i(t,e){return c(t,e)}function a(t,e){return c(t,e)}function s(t,e){for(var n=0,r=e.length-1,o=!1,i=-1;!o;){var a=Math.floor((r+n)/2),s=e[a],c=e[a+1];if(s<=t&&c>t)o=!0,i=a;else if(s>t)r=a;else if(c<t)n=a;else{if(c!==t)throw Error("non exhaustive match");o=!0,i=a+1}}return i+1}function c(t,e){var n=s(t,e);return t-e[n-1]+1}e.fillUpLineToOffset=n,e.getStartLineFromLineToOffset=r,
e.getEndLineFromLineToOffset=o,e.getStartColumnFromLineToOffset=i,e.getEndColumnFromLineToOffset=a},function(t,e,n){"use strict";function r(t){if(t instanceof s.gast.NonTerminal)return r(t.referencedRule);if(t instanceof s.gast.Terminal)return a(t);if(c.isSequenceProd(t))return o(t);if(c.isBranchingProd(t))return i(t);throw Error("non exhaustive match")}function o(t){for(var e,n=[],o=t.definition,i=0,a=o.length>i,s=!0;a&&s;)e=o[i],s=c.isOptionalProd(e),n=n.concat(r(e)),i+=1,a=o.length>i;return u.uniq(n)}function i(t){var e=u.map(t.definition,function(t){return r(t)});return u.uniq(u.flatten(e))}function a(t){return[t.terminalType]}var s=n(7),c=n(9),u=n(4);e.first=r,e.firstForSequence=o,e.firstForBranching=i,e.firstForTerminal=a},function(t,e,n){"use strict";function r(t,e,n,r){var o=h(t,e,n);return p(o,r)}function o(t,e,n,r){var o=T(t,e,n,r);return l(o[0])}function i(t,e,n){return o(t,e,v.OPTION,n)}function a(t,e,n){return o(t,e,v.REPETITION,n)}function s(t,e,n){return o(t,e,v.REPETITION_WITH_SEPARATOR,n)}function c(t,e,n){return o(t,e,v.REPETITION_MANDATORY,n)}function u(t,e,n){return o(t,e,v.REPETITION_MANDATORY_WITH_SEPARATOR,n)}function p(t,e){var n=t.length,r=A.every(t,function(t){return A.every(t,function(t){return 1===t.length})});if(e)return function(e){for(var r=A.map(e,function(t){return t.GATE}),o=0;o<n;o++){var i=t[o],a=i.length,s=r[o];if(!s||s.call(this))t:for(var c=0;c<a;c++){for(var u=i[c],p=u.length,l=0;l<p;l++){var f=this.LA(l+1);if(!(f instanceof u[l]))continue t}return o}}return-1};if(r){var o=A.map(t,function(t){return A.flatten(t)});return function(){for(var t=this.LA(1),e=0;e<n;e++)for(var r=o[e],i=r.length,a=0;a<i;a++){var s=r[a];if(t instanceof s)return e}return-1}}return function(){for(var e=0;e<n;e++){var r=t[e],o=r.length;t:for(var i=0;i<o;i++){for(var a=r[i],s=a.length,c=0;c<s;c++){var u=this.LA(c+1);if(!(u instanceof a[c]))continue t}return e}}return-1}}function l(t){var e=A.every(t,function(t){return 1===t.length}),n=t.length;if(e){var r=A.flatten(t);return function(){for(var t=this.LA(1),e=0;e<r.length;e++){var n=r[e];if(t instanceof n)return!0}return!1}}return function(){t:for(var e=0;e<n;e++){for(var r=t[e],o=r.length,i=0;i<o;i++){var a=this.LA(i+1);if(!(a instanceof r[i]))continue t}return!0}return!1}}function f(t,e){function n(t,e){return A.reduce(t,function(t,n,r){if(r!==e){var o=A.map(n,function(t){return t.partialPath});return t.concat(o)}return t},[])}function r(t,e){return void 0===A.find(t,function(t){return A.every(e,function(e,n){return e===t[n]})})}function o(t){for(var e=[],n=0;n<t;n++)e.push([]);return e}for(var i=A.map(t,function(t){return _.possiblePathsFrom([t],1)}),a=o(i.length),s=i,c=1;c<=e;c++){var u=s;s=o(u.length);for(var p=0;p<u.length;p++)for(var l=u[p],f=n(u,p),h=0;h<l.length;h++){var T=l[h].partialPath,d=l[h].suffixDef,y=r(f,T);if(y||A.isEmpty(d)||T.length===e){var O=a[p];E(O,T)||O.push(T)}else{var v=_.possiblePathsFrom(d,c+1,T);s[p]=s[p].concat(v)}}}return a}function h(t,e,n){var r=new m(t,v.ALTERNATION);return e.accept(r),f(r.result,n)}function T(t,e,n,r){var o=new m(t,n);e.accept(o);var i=o.result,a=new g(e,t,n),s=a.startWalking(),c=new y.gast.Flat(i),u=new y.gast.Flat(s);return f([c,u],r)}function E(t,e){var n=A.find(t,function(t){return e.length===t.length&&A.every(e,function(e,n){return e===t[n]})});return void 0!==n}var d=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},A=n(4),y=n(7),_=n(16),O=n(17);!function(t){t[t.OPTION=0]="OPTION",t[t.REPETITION=1]="REPETITION",t[t.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",t[t.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",t[t.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",t[t.ALTERNATION=5]="ALTERNATION"}(e.PROD_TYPE||(e.PROD_TYPE={}));var v=e.PROD_TYPE;e.buildLookaheadFuncForOr=r,e.buildLookaheadFuncForOptionalProd=o,e.buildLookaheadForOption=i,e.buildLookaheadForMany=a,e.buildLookaheadForManySep=s,e.buildLookaheadForAtLeastOne=c,e.buildLookaheadForAtLeastOneSep=u,e.buildAlternativesLookAheadFunc=p,e.buildSingleAlternativeLookaheadFunction=l;var g=function(t){function e(e,n,r){t.call(this),this.topProd=e,this.targetOccurrence=n,this.targetProdType=r}return d(e,t),e.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},e.prototype.checkIsTarget=function(t,e,n,r){return t.occurrenceInParent===this.targetOccurrence&&this.targetProdType===e&&(this.restDef=n.concat(r),!0)},e.prototype.walkOption=function(e,n,r){this.checkIsTarget(e,v.OPTION,n,r)||t.prototype.walkOption.call(this,e,n,r)},e.prototype.walkAtLeastOne=function(e,n,r){this.checkIsTarget(e,v.REPETITION_MANDATORY,n,r)||t.prototype.walkOption.call(this,e,n,r)},e.prototype.walkAtLeastOneSep=function(e,n,r){this.checkIsTarget(e,v.REPETITION_MANDATORY_WITH_SEPARATOR,n,r)||t.prototype.walkOption.call(this,e,n,r)},e.prototype.walkMany=function(e,n,r){this.checkIsTarget(e,v.REPETITION,n,r)||t.prototype.walkOption.call(this,e,n,r)},e.prototype.walkManySep=function(e,n,r){this.checkIsTarget(e,v.REPETITION_WITH_SEPARATOR,n,r)||t.prototype.walkOption.call(this,e,n,r)},e}(O.RestWalker),m=function(t){function e(e,n){t.call(this),this.targetOccurrence=e,this.targetProdType=n,this.result=[]}return d(e,t),e.prototype.checkIsTarget=function(t,e){t.occurrenceInParent===this.targetOccurrence&&this.targetProdType===e&&(this.result=t.definition)},e.prototype.visitOption=function(t){this.checkIsTarget(t,v.OPTION)},e.prototype.visitRepetition=function(t){this.checkIsTarget(t,v.REPETITION)},e.prototype.visitRepetitionMandatory=function(t){this.checkIsTarget(t,v.REPETITION_MANDATORY)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.checkIsTarget(t,v.REPETITION_MANDATORY_WITH_SEPARATOR)},e.prototype.visitRepetitionWithSeparator=function(t){this.checkIsTarget(t,v.REPETITION_WITH_SEPARATOR)},e.prototype.visitAlternation=function(t){this.checkIsTarget(t,v.ALTERNATION)},e}(y.gast.GAstVisitor);e.lookAheadSequenceFromAlternatives=f,e.getLookaheadPathsForOr=h,e.getLookaheadPathsForOptionalProd=T,e.containsPath=E},function(t,e,n){"use strict";function r(t,e,n){function o(e){return e.concat(s.drop(t,u+1))}function i(t){var i=r(o(t.definition),e,n);return c.concat(i)}void 0===n&&(n=[]),n=s.cloneArr(n);for(var c=[],u=0;n.length<e&&u<t.length;){var p=t[u];if(p instanceof a.gast.Flat)return i(p);if(p instanceof a.gast.NonTerminal)return i(p);if(p instanceof a.gast.Option)c=i(p);else{if(p instanceof a.gast.RepetitionMandatory)return i(p);if(p instanceof a.gast.RepetitionMandatoryWithSeparator)return i(p);if(p instanceof a.gast.RepetitionWithSeparator)c=i(p);else if(p instanceof a.gast.Repetition)c=i(p);else{if(p instanceof a.gast.Alternation)return s.forEach(p.definition,function(t){c=i(t)}),c;if(!(p instanceof a.gast.Terminal))throw Error("non exhaustive match");n.push(p.terminalType)}}u++}return c.push({partialPath:n,suffixDef:s.drop(t,1)}),c}var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(17),a=n(7),s=n(4),c=n(10),u=n(14),p=function(t){function e(e,n){t.call(this),this.topProd=e,this.path=n,this.possibleTokTypes=[],this.nextProductionName="",this.nextProductionOccurrence=0,this.found=!1,this.isAtEndOfPath=!1}return o(e,t),e.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=s.cloneArr(this.path.ruleStack).reverse(),this.occurrenceStack=s.cloneArr(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},e.prototype.walk=function(e,n){void 0===n&&(n=[]),this.found||t.prototype.walk.call(this,e,n)},e.prototype.walkProdRef=function(t,e,n){if(t.referencedRule.name===this.nextProductionName&&t.occurrenceInParent===this.nextProductionOccurrence){var r=e.concat(n);this.updateExpectedNext(),this.walk(t.referencedRule,r)}},e.prototype.updateExpectedNext=function(){s.isEmpty(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},e}(i.RestWalker);e.AbstractNextPossibleTokensWalker=p;var l=function(t){function e(e,n){t.call(this,e,n),this.path=n,this.nextTerminalName="",this.nextTerminalOccurrence=0,this.nextTerminalName=c.tokenName(this.path.lastTok),this.nextTerminalOccurrence=this.path.lastTokOccurrence}return o(e,t),e.prototype.walkTerminal=function(t,e,n){if(this.isAtEndOfPath&&c.tokenName(t.terminalType)===this.nextTerminalName&&t.occurrenceInParent===this.nextTerminalOccurrence&&!this.found){var r=e.concat(n),o=new a.gast.Flat(r);this.possibleTokTypes=u.first(o),this.found=!0}},e}(p);e.NextAfterTokenWalker=l;var f=function(t){function e(e,n){t.call(this),this.topRule=e,this.occurrence=n,this.result={token:void 0,occurrence:void 0,isEndOfRule:void 0}}return o(e,t),e.prototype.startWalking=function(){return this.walk(this.topRule),this.result},e}(i.RestWalker);e.AbstractNextTerminalAfterProductionWalker=f;var h=function(t){function e(){t.apply(this,arguments)}return o(e,t),e.prototype.walkMany=function(e,n,r){if(e.occurrenceInParent===this.occurrence){var o=s.first(n.concat(r));this.result.isEndOfRule=void 0===o,o instanceof a.gast.Terminal&&(this.result.token=o.terminalType,this.result.occurrence=o.occurrenceInParent)}else t.prototype.walkMany.call(this,e,n,r)},e}(f);e.NextTerminalAfterManyWalker=h;var T=function(t){function e(){t.apply(this,arguments)}return o(e,t),e.prototype.walkManySep=function(e,n,r){if(e.occurrenceInParent===this.occurrence){var o=s.first(n.concat(r));this.result.isEndOfRule=void 0===o,o instanceof a.gast.Terminal&&(this.result.token=o.terminalType,this.result.occurrence=o.occurrenceInParent)}else t.prototype.walkManySep.call(this,e,n,r)},e}(f);e.NextTerminalAfterManySepWalker=T;var E=function(t){function e(){t.apply(this,arguments)}return o(e,t),e.prototype.walkAtLeastOne=function(e,n,r){if(e.occurrenceInParent===this.occurrence){var o=s.first(n.concat(r));this.result.isEndOfRule=void 0===o,o instanceof a.gast.Terminal&&(this.result.token=o.terminalType,this.result.occurrence=o.occurrenceInParent)}else t.prototype.walkAtLeastOne.call(this,e,n,r)},e}(f);e.NextTerminalAfterAtLeastOneWalker=E;var d=function(t){function e(){t.apply(this,arguments)}return o(e,t),e.prototype.walkAtLeastOneSep=function(e,n,r){if(e.occurrenceInParent===this.occurrence){var o=s.first(n.concat(r));this.result.isEndOfRule=void 0===o,o instanceof a.gast.Terminal&&(this.result.token=o.terminalType,this.result.occurrence=o.occurrenceInParent)}else t.prototype.walkAtLeastOneSep.call(this,e,n,r)},e}(f);e.NextTerminalAfterAtLeastOneSepWalker=d,e.possiblePathsFrom=r},function(t,e,n){"use strict";function r(t,e,n){var r=[new o.gast.Option([new o.gast.Terminal(t.separator)].concat(t.definition))],i=r.concat(e,n);return i}var o=n(7),i=n(4),a=function(){function t(){}return t.prototype.walk=function(t,e){var n=this;void 0===e&&(e=[]),i.forEach(t.definition,function(r,a){var s=i.drop(t.definition,a+1);if(r instanceof o.gast.NonTerminal)n.walkProdRef(r,s,e);else if(r instanceof o.gast.Terminal)n.walkTerminal(r,s,e);else if(r instanceof o.gast.Flat)n.walkFlat(r,s,e);else if(r instanceof o.gast.Option)n.walkOption(r,s,e);else if(r instanceof o.gast.RepetitionMandatory)n.walkAtLeastOne(r,s,e);else if(r instanceof o.gast.RepetitionMandatoryWithSeparator)n.walkAtLeastOneSep(r,s,e);else if(r instanceof o.gast.RepetitionWithSeparator)n.walkManySep(r,s,e);else if(r instanceof o.gast.Repetition)n.walkMany(r,s,e);else{if(!(r instanceof o.gast.Alternation))throw Error("non exhaustive match");n.walkOr(r,s,e)}})},t.prototype.walkTerminal=function(t,e,n){},t.prototype.walkProdRef=function(t,e,n){},t.prototype.walkFlat=function(t,e,n){var r=e.concat(n);this.walk(t,r)},t.prototype.walkOption=function(t,e,n){var r=e.concat(n);this.walk(t,r)},t.prototype.walkAtLeastOne=function(t,e,n){var r=[new o.gast.Option(t.definition)].concat(e,n);this.walk(t,r)},t.prototype.walkAtLeastOneSep=function(t,e,n){var o=r(t,e,n);this.walk(t,o)},t.prototype.walkMany=function(t,e,n){var r=[new o.gast.Option(t.definition)].concat(e,n);this.walk(t,r)},t.prototype.walkManySep=function(t,e,n){var o=r(t,e,n);this.walk(t,o)},t.prototype.walkOr=function(t,e,n){var r=this,a=e.concat(n);i.forEach(t.definition,function(t){var e=new o.gast.Flat([t]);r.walk(e,a)})},t}();e.RestWalker=a},function(t,e,n){"use strict";function r(t){var e=new c.HashTable;return l.forEach(t,function(t){var n=new T(t).startWalking();e.putAll(n)}),e}function o(t,e){return t.name+e+f.IN}function i(t){var e=h.tokenName(t.terminalType);return e+t.occurrenceInParent+f.IN}var a=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},s=n(17),c=n(3),u=n(7),p=n(14),l=n(4),f=n(19),h=n(10),T=function(t){function e(e){t.call(this),this.topProd=e,this.follows=new c.HashTable}return a(e,t),e.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},e.prototype.walkTerminal=function(t,e,n){},e.prototype.walkProdRef=function(t,e,n){var r=o(t.referencedRule,t.occurrenceInParent)+this.topProd.name,i=e.concat(n),a=new u.gast.Flat(i),s=p.first(a);this.follows.put(r,s)},e}(s.RestWalker);e.ResyncFollowsWalker=T,e.computeAllProdsFollows=r,e.buildBetweenProdsFollowPrefix=o,e.buildInProdFollowPrefix=i},function(t,e){"use strict";e.IN="_~IN~_"},function(t,e,n){"use strict";function r(t,n,r){e.terminalNameToConstructor=r;var i=" "+t,a=y(" "+i),s=_(a),c=O(s),u=new M.Range(0,t.length+2);return o(n,u,c,t)}function o(t,e,n,r){var o=new w.gast.Rule(t,[],r);return d(o,e,n)}function i(t,e){switch(t.type){case U.AT_LEAST_ONE:return u(t,e);case U.AT_LEAST_ONE_SEP:return p(t,e);case U.MANY_SEP:return f(t,e);case U.MANY:return l(t,e);case U.OPTION:return T(t,e);case U.OR:return E(t,e);case U.FLAT:return d(new w.gast.Flat([]),t.range,e);case U.REF:return a(t);case U.TERMINAL:return s(t);default:throw Error("non exhaustive match")}}function a(t){var e=K.exec(t.text),n=void 0===e[1],r=n?1:parseInt(e[1],10),o=e[2],i=new w.gast.NonTerminal(o,(void 0),r);return i.implicitOccurrenceIndex=n,i}function s(t){var n=b.exec(t.text),r=void 0===n[1],o=r?1:parseInt(n[1],10),i=n[2],a=e.terminalNameToConstructor[i];if(!a)throw Error("Terminal Token name: "+i+" not found");var s=new w.gast.Terminal(a,o);return s.implicitOccurrenceIndex=r,s}function c(t,e,n,r){var o=t.exec(n.text),i=void 0===o[1];return e.occurrenceInParent=i?1:parseInt(o[1],10),e.implicitOccurrenceIndex=i,d(e,n.range,r)}function u(t,e){return c(q,new w.gast.RepetitionMandatory([]),t,e)}function p(t,e){return h(t,e,w.gast.RepetitionMandatoryWithSeparator,X)}function l(t,e){return c(j,new w.gast.Repetition([]),t,e)}function f(t,e){return h(t,e,w.gast.RepetitionWithSeparator,z)}function h(t,n,r,o){var i=o.exec(t.text),a=void 0===i[1],s=a?1:parseInt(i[1],10),c=i[2],u=e.terminalNameToConstructor[c];if(!u)throw Error("Separator Terminal Token name: "+c+" not found");var p=new r([],u,s);return p.implicitOccurrenceIndex=a,d(p,t.range,n)}function T(t,e){return c(W,new w.gast.Option([]),t,e)}function E(t,e){return c(J,new w.gast.Alternation([]),t,e)}function d(t,e,n){var r=A(e,n),o=D.sortBy(r,function(t){return t.range.start}),a=[];return D.forEach(o,function(t){a.push(i(t,n))}),t.definition=a,t}function A(t,e){return D.filter(e,function(n){var r=t.strictlyContainsRange(n.range),o=D.every(e,function(e){var r=e.range.strictlyContainsRange(n.range),o=e.range.isStrictlyContainedInRange(t);return!(r&&o)});return r&&o})}function y(t){var e=t.replace(et,""),n=e.replace(nt,"");return n}function _(t){var e=t.replace(rt,""),n=e.replace(ot,"");return n}function O(t){var e=v(t),n=g(t),r=m(t),o=N(t),i=R(t),a=L(t),s=S(t),c=I(t);return[].concat(e,n,r,o,i,a,s,c)}function v(t){return k(t,U.TERMINAL,Y)}function g(t){return k(t,U.REF,H)}function m(t){return x(t,U.AT_LEAST_ONE,$)}function N(t){return x(t,U.AT_LEAST_ONE_SEP,Z)}function R(t){return x(t,U.MANY,V)}function L(t){return x(t,U.MANY_SEP,B)}function S(t){return x(t,U.OPTION,G)}function I(t){var e=x(t,U.OR,Q),n=P(e);return e.concat(n)}function P(t){var e=[];D.forEach(t,function(t){var n=C(t.text,U.FLAT,tt,it),r=t.range.start;D.forEach(n,function(t){t.range.start+=r,t.range.end+=r}),e=e.concat(n)});var n=D.uniq(e,function(t){return t.type+"~"+t.range.start+"~"+t.range.end+"~"+t.text});return n}function k(t,e,n){for(var r,o=[];r=n.exec(t);){var i=r.index,a=n.lastIndex,s=new M.Range(i,a),c=r[0];o.push({range:s,text:c,type:e})}return o}function x(t,e,n){return C(t,e,n,at)}function C(t,e,n,r){for(var o,i=[];o=n.exec(t);){var a=o.index,s=r(a+o[0].length,t),c=new M.Range(a,s),u=t.substr(a,s-a+1);i.push({range:c,text:u,type:e})}return i}function F(t,e,n,r){for(var o=[1],i=-1;!D.isEmpty(o)&&i+n<r.length;){i++;var a=r.charAt(n+i);a===t?o.push(1):a===e&&o.pop()}if(D.isEmpty(o))return i+n;throw new Error("INVALID INPUT TEXT, UNTERMINATED PARENTHESIS")}var M=n(21),w=n(7),D=n(4);!function(t){t[t.OPTION=0]="OPTION",t[t.OR=1]="OR",t[t.MANY=2]="MANY",t[t.MANY_SEP=3]="MANY_SEP",t[t.AT_LEAST_ONE=4]="AT_LEAST_ONE",t[t.AT_LEAST_ONE_SEP=5]="AT_LEAST_ONE_SEP",t[t.REF=6]="REF",t[t.TERMINAL=7]="TERMINAL",t[t.FLAT=8]="FLAT"}(e.ProdType||(e.ProdType={}));var U=e.ProdType,b=/\.\s*CONSUME(\d)?\s*\(\s*(?:[a-zA-Z_$]\w*\s*\.\s*)*([a-zA-Z_$]\w*)/,Y=new RegExp(b.source,"g"),K=/\.\s*SUBRULE(\d)?\s*\(\s*(?:[a-zA-Z_$]\w*\s*\.\s*)*([a-zA-Z_$]\w*)/,H=new RegExp(K.source,"g"),W=/\.\s*OPTION(\d)?\s*\(/,G=new RegExp(W.source,"g"),j=/\.\s*MANY(\d)?\s*\(/,V=new RegExp(j.source,"g"),z=/\.\s*MANY_SEP(\d)?\s*\(\s*(?:[a-zA-Z_$]\w*\s*\.\s*)*([a-zA-Z_$]\w*)/,B=new RegExp(z.source,"g"),X=/\.\s*AT_LEAST_ONE_SEP(\d)?\s*\(\s*(?:[a-zA-Z_$]\w*\s*\.\s*)*([a-zA-Z_$]\w*)/,Z=new RegExp(X.source,"g"),q=/\.\s*AT_LEAST_ONE(\d)?\s*\(/,$=new RegExp(q.source,"g"),J=/\.\s*OR(\d)?\s*\(/,Q=new RegExp(J.source,"g"),tt=/\s*(ALT)\s*:/g;e.terminalNameToConstructor={},e.buildTopProduction=r,e.buildProdGast=i,e.getDirectlyContainedRanges=A;var et=/\/\/.*/g,nt=/\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\//g,rt=/"([^\\"]+|\\([bfnrtv"\\/]|u[0-9a-fA-F]{4}))*"/g,ot=/'([^\\']+|\\([bfnrtv'\\/]|u[0-9a-fA-F]{4}))*'/g;e.removeComments=y,e.removeStringLiterals=_,e.createRanges=O,e.createTerminalRanges=v,e.createRefsRanges=g,e.createAtLeastOneRanges=m,e.createAtLeastOneSepRanges=N,e.createManyRanges=R,e.createManySepRanges=L,e.createOptionRanges=S,e.createOrRanges=I;var it=D.partial(F,"{","}"),at=D.partial(F,"(",")");e.createOrPartRanges=P,e.findClosingOffset=F},function(t,e){"use strict";function n(t,e){return!(t<0||e<t)}var r=function(){function t(t,e){if(this.start=t,this.end=e,!n(t,e))throw new Error("INVALID RANGE")}return t.prototype.contains=function(t){return this.start<=t&&this.end>=t},t.prototype.containsRange=function(t){return this.start<=t.start&&this.end>=t.end},t.prototype.isContainedInRange=function(t){return t.containsRange(this)},t.prototype.strictlyContainsRange=function(t){return this.start<t.start&&this.end>t.end},t.prototype.isStrictlyContainedInRange=function(t){return t.strictlyContainsRange(this)},t}();e.Range=r,e.isValidRange=n},function(t,e,n){"use strict";function r(){o.clearCache()}var o=n(2);e.clearCache=r}])});